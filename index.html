<!DOCTYPE html>
<html>
	<head>
		<title>Upload Photos</title>
		<link rel="stylesheet" href="./style.css" />
	<head>
	<body>

		<h1>Upload Photos</h1>

		<form>
			<input type="file" multiple />
			<div class="photos">
				<img />
				<img />
				<img />
				<img />
				<img />
				<img />
				<img />
			</div>
			<button type="submit">Upload</button>
		</form>

		<script>

			// Once files have been selected
			document.querySelector('form input[type=file]').addEventListener('change', function(event){

				// Read files
				var files = event.target.files;

				// Iterate through files
				for (var i = 0; i < files.length; i++) {

					// Ensure it's an image
					if (files[i].type.match(/image.*/)) {

						console.log(files[i]);

						// Load image
						var reader = new FileReader();
						reader.onload = function (readerEvent) {
							var image = new Image();
							image.onload = function (imageEvent) {

								// Resize image
								var canvas = document.createElement('canvas');
								var max_size = 800;
								var width = image.width;
								var height = image.height;
								if (width > height) {
									if (width > max_size) {
										height *= max_size / width;
										width = max_size;
									}
								} else {
									if (height > max_size) {
										width *= max_size / height;
										height = max_size;
									}
								}
								canvas.width = width;
								canvas.height = height;
								canvas.getContext('2d').drawImage(image, 0, 0, width, height);

								console.log(canvas.toDataURL('image/png'));

							}

							image.src = readerEvent.target.result;

						}
						reader.readAsDataURL(files[i]);
					}

				}

				// Clear files
				event.target.value = '';

			});
		</script>

	</body>
</html